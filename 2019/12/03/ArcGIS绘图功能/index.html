<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="随感，遥感，机器学习....想到什么写什么"><title>ArcGIS绘图功能 | 吴蔚</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ArcGIS绘图功能</h1><a id="logo" href="/.">吴蔚</a><p class="description">生命不息，折腾不止！</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ArcGIS绘图功能</h1><div class="post-meta">Dec 3, 2019<span> | </span><span class="category"><a href="/categories/学习/">学习</a></span></div><a class="disqus-comment-count" href="/2019/12/03/ArcGIS绘图功能/#vcomment"><span class="valine-comment-count" data-xid="/2019/12/03/ArcGIS绘图功能/"></span><span> 条评论</span></a><div class="post-content"><h3 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h3><p>&nbsp; &nbsp; &nbsp; &nbsp;在GIS应用中有一个十分重要的应用为绘图应用，一直以来基于Web的GIS在绘图方面的应用都是弱项，这其中主要问题在于Web GIS在应用过程中，所有数据都是通过浏览器进行存储和渲染，而浏览器所能够使用到的计算机资源是有限的，因此相比于给予客户端的GIS软件，基于Web GIS的应用中绘制的功能较弱，因此Web GIS更偏向于数据展示，然而随着计算机性能的发展与WebGL技术的发展，Web GIS的应用领域得到了极大的扩展，以前看起来较为复杂的绘制功能实际上也能够在浏览器端得到比较好的实现，下面我将仔细描述一下通过ArcGIS进行WebGIS应用的绘图功能。</p>
<h3 id="ArcGIS绘图功能说明："><a href="#ArcGIS绘图功能说明：" class="headerlink" title="ArcGIS绘图功能说明："></a>ArcGIS绘图功能说明：</h3><p>&nbsp; &nbsp; &nbsp; &nbsp;基于ArcGIS的绘图功能的实现实际上主要是通过Draw这个对象来实现的，在 <a href="https://developers.arcgis.com/javascript/latest/api-reference/esri-views-draw-Draw.html" target="_blank" rel="noopener">官网</a>上会有比较详细的Demo和说明，但是为了方便理解以及应用，我这里还是进行一些简单的总结：</p>
<ul>
<li>1 通过Sketch来实现绘图功能，实际上简单的来说就是指直接通过Sketch Widget这个控件来实现绘图功能；</li>
<li>2 通过Draw函数实现绘图功能；</li>
</ul>
<p>&nbsp; &nbsp; &nbsp; &nbsp;如果想要采用第一种方法进行绘制，则方法很简单，引入对应的控件，然后就能够实现画图功能，包括绘制点，线，面以及一些包括正方形，圆形在内的规则形状，同时还提供了选择、编辑以及删除绘制的图形等功能，通过此控件进行绘制主要优点在于使用简单，能够快速的搭建起一个绘制的功能，但是通过此控件进行绘图也存在着一些问题，主要问题在于无法进行定制化的应用，如果只是需要一个简单而且功能全面的绘图控件，则此控件完全符合要求，如果功能要求有较强的定制化，则此控件可能难以满足要求，另外对于完成的控件的定制化开发可能需要花费更多的时间，如果大家想要了解Sketch控件的使用，直接关注<a href="https://developers.arcgis.com/javascript/latest/sample-code/sketch-geometries/index.html" target="_blank" rel="noopener">ArcGIS的Demo网站</a>查看示例代码就可以了。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;对于大部分应用来说，直接使用空间远远满足不了应用要求，需要提供更加底层的API进行定制化的开发，这样我们就需要使用到Draw模块了。实际上这个模块的使用过程也比较简单，主要包括以下几个步骤：1.引入Draw模块；2.Draw模块与view视图进行绑定；3.定义绘制的方法；4.绘制方法d的响应；下面我们针对以上几个步骤进行分别的说明：</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;1.引入绘制函数：“esri/views/draw/Draw”，直接通过require模块引入绘制函数模块，然后直接定义全局绘制函数绑定view以便于进行绘制；2.Draw模块与View进行绑定，定义绘制方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> // create a new instance of draw</span><br><span class="line">var draw = new Draw(&#123;</span><br><span class="line">  view: view</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// create an instance of draw polyline action</span><br><span class="line">// the polyline vertices will be only added when</span><br><span class="line">// the pointer is clicked on the view</span><br><span class="line">var action = draw.create(&quot;polyline&quot;, &#123;mode: &quot;click&quot;&#125;);</span><br><span class="line"></span><br><span class="line">// fires when a vertex is added</span><br><span class="line">action.on(&quot;vertex-add&quot;, function (evt) &#123;</span><br><span class="line">  measureLine(evt.vertices);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// fires when the pointer moves</span><br><span class="line">action.on(&quot;cursor-update&quot;, function (evt) &#123;</span><br><span class="line">  measureLine(evt.vertices);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// fires when the drawing is completed</span><br><span class="line">action.on(&quot;draw-complete&quot;, function (evt) &#123;</span><br><span class="line">  measureLine(evt.vertices);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// fires when a vertex is removed</span><br><span class="line">action.on(&quot;vertex-remove&quot;, function (evt) &#123;</span><br><span class="line">  measureLine(evt.vertices);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function measureLine(vertices) &#123;</span><br><span class="line">  view.graphics.removeAll();</span><br><span class="line"></span><br><span class="line">  var line = createLine(vertices);</span><br><span class="line">  var lineLength = geometryEngine.geodesicLength(line, &quot;miles&quot;);</span><br><span class="line">  var graphic = createGraphic(line);</span><br><span class="line">  view.graphics.add(graphic);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过action定义绘制方法，在ArcGIS中的绘制方法包括：Point，MutiPoint，Polyline，Polygon，定义绘制方法之后就需要响应绘制函数，实际上对于绘制不同的地物，对应需要响应的方法也存在差异，如果需要将绘制的结果进行保存，一般l来说我们再新建一个GraphicsLayer图层，通过此图层进行保存，将数据保存到图层中。<br>整体代码为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"utf-8"</span> /&gt;</span><br><span class="line">    &lt;meta</span><br><span class="line">      name=<span class="string">"viewport"</span></span><br><span class="line">      content=<span class="string">"initial-scale=1,maximum-scale=1,user-scalable=no"</span></span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;title&gt;Draw polyline - <span class="number">4.13</span>&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;link</span></span><br><span class="line"><span class="regexp">      rel="stylesheet"</span></span><br><span class="line"><span class="regexp">      href="https:/</span><span class="regexp">/js.arcgis.com/</span><span class="number">4.13</span>/esri/themes/light/main.css<span class="string">"</span></span><br><span class="line"><span class="string">    /&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>https:<span class="comment">//js.arcgis.com/4.13/"&gt;&lt;/script&gt;</span></span><br><span class="line">    &lt;script src=<span class="string">"http://libs.baidu.com/jquery/2.1.4/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      html,</span><br><span class="line">      body,</span><br><span class="line">      #viewDiv &#123;</span><br><span class="line">        height: <span class="number">100</span>%;</span><br><span class="line">        width: <span class="number">100</span>%;</span><br><span class="line">        margin: <span class="number">0</span>;</span><br><span class="line">        padding: <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;script&gt;</span></span><br><span class="line"><span class="regexp">      require([</span></span><br><span class="line"><span class="regexp">        "esri/Map",</span></span><br><span class="line"><span class="regexp">        "esri/views/MapView",</span></span><br><span class="line"><span class="regexp">        "esri/views/draw/Draw",</span></span><br><span class="line"><span class="regexp">        "esri/Graphic",</span></span><br><span class="line"><span class="regexp">        "esri/layers/GraphicsLayer",</span></span><br><span class="line"><span class="regexp">        "esri/geometry/geometryEngine"</span></span><br><span class="line"><span class="regexp">      ], function(Map, MapView, Draw, Graphic, GraphicsLayer,geometryEngine) &#123;</span></span><br><span class="line"><span class="regexp">        const map = new Map(&#123;</span></span><br><span class="line"><span class="regexp">          basemap: "gray"</span></span><br><span class="line"><span class="regexp">        &#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        const view = new MapView(&#123;</span></span><br><span class="line"><span class="regexp">          container: "viewDiv",</span></span><br><span class="line"><span class="regexp">          map: map,</span></span><br><span class="line"><span class="regexp">          zoom: 16,</span></span><br><span class="line"><span class="regexp">          center: [18.06, 59.34]</span></span><br><span class="line"><span class="regexp">        &#125;);</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/var layerSave = new GraphicsLayer();</span></span><br><span class="line"><span class="regexp">        var layerSavePoint = new GraphicsLayer();</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/map.add(layerSave);</span></span><br><span class="line"><span class="regexp">        map.add(layerSavePoint);</span></span><br><span class="line"><span class="regexp">        var param=&#123;</span></span><br><span class="line"><span class="regexp">              "devType":0,</span></span><br><span class="line"><span class="regexp">              "schemeId":"07b0486b0e014b5ba80685d72dc38351"</span></span><br><span class="line"><span class="regexp">            &#125;;</span></span><br><span class="line"><span class="regexp">        $.ajax(&#123;</span></span><br><span class="line"><span class="regexp">              url: "http:/</span><span class="regexp">/192.168.43.214:8087/</span>visual/query-project-scheme-dev<span class="string">",</span></span><br><span class="line"><span class="string">              type: "</span>post<span class="string">",</span></span><br><span class="line"><span class="string">              data: JSON.stringify(param),</span></span><br><span class="line"><span class="string">              headers: &#123;</span></span><br><span class="line"><span class="string">                  'Origin':"</span>*<span class="string">",</span></span><br><span class="line"><span class="string">                  'content-type': "</span>application/json<span class="string">",</span></span><br><span class="line"><span class="string">                  // 'token': "</span>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1NzQ5MjUzNzAsInVzZXJuYW1lIjoiaHowMDEifQ.P1Rzs0A6klHU6CZqBuItibpya-kfsT5kJ1w7EboJtAo<span class="string">"</span></span><br><span class="line"><span class="string">              &#125;,</span></span><br><span class="line"><span class="string">              success: function(result) &#123;  //这里就是我出错的地方</span></span><br><span class="line"><span class="string">                console.log(result.data.list[0]);</span></span><br><span class="line"><span class="string">                for(var i=0;i&lt;result.data.list.length;++i)&#123;</span></span><br><span class="line"><span class="string">                  var graphic=Graphic.fromJSON(JSON.parse(result.data.list[i]["</span>geometryInfo<span class="string">"]));</span></span><br><span class="line"><span class="string">                  layerSavePoint.graphics.add(graphic);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">              &#125;,</span></span><br><span class="line"><span class="string">              error: function(data) &#123;</span></span><br><span class="line"><span class="string">                console.log("</span>请求出错<span class="string">");</span></span><br><span class="line"><span class="string">              &#125;</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // add the button for the draw tool</span></span><br><span class="line"><span class="string">        view.ui.add("</span>line-button<span class="string">", "</span>top-left<span class="string">");</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        const draw = new Draw(&#123;</span></span><br><span class="line"><span class="string">          view: view</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        var drawType=0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // draw polyline button</span></span><br><span class="line"><span class="string">        document.getElementById("</span>line-button<span class="string">").onclick = function() &#123;</span></span><br><span class="line"><span class="string">            const action = draw.create("</span>polyline<span class="string">");</span></span><br><span class="line"><span class="string">            action.on(</span></span><br><span class="line"><span class="string">              [</span></span><br><span class="line"><span class="string">                "</span>vertex-add<span class="string">",</span></span><br><span class="line"><span class="string">                "</span>vertex-remove<span class="string">",</span></span><br><span class="line"><span class="string">                "</span>cursor-update<span class="string">",</span></span><br><span class="line"><span class="string">                "</span>redo<span class="string">",</span></span><br><span class="line"><span class="string">                "</span>undo<span class="string">"</span></span><br><span class="line"><span class="string">              ],</span></span><br><span class="line"><span class="string">              updateVertices</span></span><br><span class="line"><span class="string">            );  </span></span><br><span class="line"><span class="string">            action.on("</span>draw-complete<span class="string">", function (evt) &#123;</span></span><br><span class="line"><span class="string">              saveLineGraphic(evt);</span></span><br><span class="line"><span class="string">            &#125;);</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Checks if the last vertex is making the line intersect itself.</span></span><br><span class="line"><span class="string">        function updateVertices(event) &#123;</span></span><br><span class="line"><span class="string">          // create a polyline from returned vertices</span></span><br><span class="line"><span class="string">          if (event.vertices.length &gt; 1) &#123;</span></span><br><span class="line"><span class="string">            const result = createLineGraphic(event);</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // create a new graphic presenting the polyline that is being drawn on the view</span></span><br><span class="line"><span class="string">        function createLineGraphic(event) &#123;</span></span><br><span class="line"><span class="string">            const vertices = event.vertices;</span></span><br><span class="line"><span class="string">            view.graphics.removeAll();</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            // a graphic representing the polyline that is being drawn</span></span><br><span class="line"><span class="string">            const graphic = new Graphic(&#123;</span></span><br><span class="line"><span class="string">                geometry: &#123;</span></span><br><span class="line"><span class="string">                type: "</span>polyline<span class="string">",</span></span><br><span class="line"><span class="string">                paths: vertices,</span></span><br><span class="line"><span class="string">                spatialReference: view.spatialReference</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                symbol: &#123;</span></span><br><span class="line"><span class="string">                type: "</span>simple-line<span class="string">", // autocasts as new SimpleFillSymbol</span></span><br><span class="line"><span class="string">                color: [4, 90, 141],</span></span><br><span class="line"><span class="string">                width: 4,</span></span><br><span class="line"><span class="string">                cap: "</span>round<span class="string">",</span></span><br><span class="line"><span class="string">                join: "</span>round<span class="string">",</span></span><br><span class="line"><span class="string">                style: "</span>dash<span class="string">"</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;);</span></span><br><span class="line"><span class="string">            view.graphics.add(graphic);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        function saveLineGraphic(event)&#123;</span></span><br><span class="line"><span class="string">            const vertices = event.vertices;</span></span><br><span class="line"><span class="string">            view.graphics.removeAll();</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            // a graphic representing the polyline that is being drawn</span></span><br><span class="line"><span class="string">            const graphic = new Graphic(&#123;</span></span><br><span class="line"><span class="string">                geometry: &#123;</span></span><br><span class="line"><span class="string">                type: "</span>polyline<span class="string">",</span></span><br><span class="line"><span class="string">                paths: vertices,</span></span><br><span class="line"><span class="string">                spatialReference: view.spatialReference</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                symbol: &#123;</span></span><br><span class="line"><span class="string">                type: "</span>simple-line<span class="string">", // autocasts as new SimpleFillSymbol</span></span><br><span class="line"><span class="string">                color: [4, 90, 141],</span></span><br><span class="line"><span class="string">                width: 4,</span></span><br><span class="line"><span class="string">                cap: "</span>round<span class="string">",</span></span><br><span class="line"><span class="string">                join: "</span>round<span class="string">",</span></span><br><span class="line"><span class="string">                style: "</span>dash<span class="string">"</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;);</span></span><br><span class="line"><span class="string">            layerSavePoint.graphics.add(graphic);</span></span><br><span class="line"><span class="string">            var param=&#123;</span></span><br><span class="line"><span class="string">              "</span>devType<span class="string">":0,</span></span><br><span class="line"><span class="string">              "</span>geometryInfo<span class="string">":JSON.stringify(graphic.toJSON()),</span></span><br><span class="line"><span class="string">              "</span>schemeId<span class="string">":"</span><span class="number">07</span>b0486b0e014b5ba80685d72dc38351<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;;</span></span><br><span class="line"><span class="string">            $.ajax(&#123;</span></span><br><span class="line"><span class="string">              url: "</span>http:<span class="comment">//192.168.43.214:8087/visual/add-project-scheme-dev",</span></span><br><span class="line">              type: <span class="string">"post"</span>,</span><br><span class="line">              data: <span class="built_in">JSON</span>.stringify(param),</span><br><span class="line">              headers: &#123;</span><br><span class="line">                  <span class="string">'Origin'</span>:<span class="string">"*"</span>,</span><br><span class="line">                  <span class="string">'content-type'</span>: <span class="string">"application/json"</span>,</span><br><span class="line">                  <span class="comment">// 'token': "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1NzQ5MjUzNzAsInVzZXJuYW1lIjoiaHowMDEifQ.P1Rzs0A6klHU6CZqBuItibpya-kfsT5kJ1w7EboJtAo"</span></span><br><span class="line">              &#125;,</span><br><span class="line">              success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;  <span class="comment">//这里就是我出错的地方</span></span><br><span class="line">                <span class="built_in">console</span>.log(result.msg);</span><br><span class="line">              &#125;,</span><br><span class="line">              error: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"请求出错"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">previewPointGraphic</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> coordinates=event.coordinates;</span><br><span class="line">            view.graphics.removeAll();</span><br><span class="line">            <span class="keyword">var</span> point = &#123;</span><br><span class="line">                type: <span class="string">"point"</span>, <span class="comment">// autocasts as /Point</span></span><br><span class="line">                x: coordinates[<span class="number">0</span>],</span><br><span class="line">                y: coordinates[<span class="number">1</span>],</span><br><span class="line">                spatialReference: view.spatialReference</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(&#123;</span><br><span class="line">                geometry: point,</span><br><span class="line">                symbol: &#123;</span><br><span class="line">                type: <span class="string">"picture-marker"</span>, <span class="comment">// autocasts as SimpleMarkerSymbol</span></span><br><span class="line">                url: <span class="string">"https://static.arcgis.com/images/Symbols/Shapes/BlackStarLargeB.png"</span>,</span><br><span class="line">                size: <span class="string">"16px"</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            view.graphics.add(graphic);            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">savePointGraphic</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> coordinates=event.coordinates;</span><br><span class="line">            view.graphics.removeAll();</span><br><span class="line">            <span class="keyword">var</span> point = &#123;</span><br><span class="line">                type: <span class="string">"point"</span>, <span class="comment">// autocasts as /Point</span></span><br><span class="line">                x: coordinates[<span class="number">0</span>],</span><br><span class="line">                y: coordinates[<span class="number">1</span>],</span><br><span class="line">                spatialReference: view.spatialReference</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(&#123;</span><br><span class="line">                geometry: point,</span><br><span class="line">                symbol: &#123;</span><br><span class="line">                type: <span class="string">"picture-marker"</span>, <span class="comment">// autocasts as SimpleMarkerSymbol</span></span><br><span class="line">                url: <span class="string">"https://static.arcgis.com/images/Symbols/Shapes/BlackStarLargeB.png"</span>,</span><br><span class="line">                size: <span class="string">"16px"</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            layerSavePoint.graphics.add(graphic);</span><br><span class="line">            <span class="keyword">var</span> param=&#123;</span><br><span class="line">              <span class="string">"devType"</span>:<span class="number">0</span>,</span><br><span class="line">              <span class="string">"geometryInfo"</span>:<span class="built_in">JSON</span>.stringify(graphic.toJSON()),</span><br><span class="line">              <span class="string">"schemeId"</span>:<span class="string">"07b0486b0e014b5ba80685d72dc38351"</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">//console.log(JSON.stringify(graphic.toJSON()));</span></span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">              url: <span class="string">"http://192.168.43.214:8087/visual/add-project-scheme-dev"</span>,</span><br><span class="line">              type: <span class="string">"post"</span>,</span><br><span class="line">              data: <span class="built_in">JSON</span>.stringify(param),</span><br><span class="line">              headers: &#123;</span><br><span class="line">                  <span class="string">'Origin'</span>:<span class="string">"*"</span>,</span><br><span class="line">                  <span class="string">'content-type'</span>: <span class="string">"application/json"</span>,</span><br><span class="line">                  <span class="comment">// 'token': "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1NzQ5MjUzNzAsInVzZXJuYW1lIjoiaHowMDEifQ.P1Rzs0A6klHU6CZqBuItibpya-kfsT5kJ1w7EboJtAo"</span></span><br><span class="line">              &#125;,</span><br><span class="line">              success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;  <span class="comment">//这里就是我出错的地方</span></span><br><span class="line">                <span class="built_in">console</span>.log(result.msg);</span><br><span class="line">              &#125;,</span><br><span class="line">              error: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"请求出错"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//console.log(JSON.stringify(graphic.toJSON()));</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">"viewDiv"</span>&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        id=<span class="string">"line-button"</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span></span>=<span class="string">"esri-widget esri-widget--button esri-interactive"</span></span><br><span class="line">        title=<span class="string">"Draw polyline"</span></span><br><span class="line">      &gt;</span><br><span class="line">        &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"esri-icon-polyline"</span>&gt;&lt;/span&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure></div><div class="tags"><a href="/tags/ArcGIS开发/">ArcGIS开发</a></div><div class="post-nav"><a class="pre" href="/2020/01/04/大侠之死/">大侠之死</a><a class="next" href="/2019/11/17/无所谓与焦虑/">无所谓与焦虑</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'true' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'uHNJtTxLkcGm3VRtuRGk53hb-gzGzoHsz',
  appKey:'h8s1QFO2dLQ62H0axpKB6WnD',
  placeholder:'说点啥吧...',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"><input type="hidden" name="si" value="http://www.wuweiblog.com"><input name="tn" type="hidden" value="bds"><input name="cl" type="hidden" value="3"><input name="ct" type="hidden" value="2097152"><input name="s" type="hidden" value="on"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/书评/">书评</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/图像处理/">图像处理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习/">学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/小说/">小说</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/影评/">影评</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数学/">数学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/游戏/">游戏</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/点云处理/">点云处理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随感/">随感</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/ArcGIS，前端开发/" style="font-size: 15px;">ArcGIS，前端开发</a> <a href="/tags/ArcGIS环境配置/" style="font-size: 15px;">ArcGIS环境配置</a> <a href="/tags/ArcGIS开发/" style="font-size: 15px;">ArcGIS开发</a> <a href="/tags/开发/" style="font-size: 15px;">开发</a> <a href="/tags/linux-学习/" style="font-size: 15px;">linux 学习</a> <a href="/tags/学习/" style="font-size: 15px;">学习</a> <a href="/tags/数学/" style="font-size: 15px;">数学</a> <a href="/tags/图像处理数学原理/" style="font-size: 15px;">图像处理数学原理</a> <a href="/tags/系统架构-学习/" style="font-size: 15px;">系统架构 学习</a> <a href="/tags/效率/" style="font-size: 15px;">效率</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/机器学习，图像处理/" style="font-size: 15px;">机器学习，图像处理</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/tensorflow学习/" style="font-size: 15px;">tensorflow学习</a> <a href="/tags/随感/" style="font-size: 15px;">随感</a> <a href="/tags/Mary-and-Max，影评/" style="font-size: 15px;">Mary and Max，影评</a> <a href="/tags/沉默的大多数，书评/" style="font-size: 15px;">沉默的大多数，书评</a> <a href="/tags/断舍离，书评/" style="font-size: 15px;">断舍离，书评</a> <a href="/tags/雪中悍刀行-书评/" style="font-size: 15px;">雪中悍刀行,书评</a> <a href="/tags/呼兰河传-书评/" style="font-size: 15px;">呼兰河传,书评</a> <a href="/tags/将夜-书评/" style="font-size: 15px;">将夜,书评</a> <a href="/tags/中国经济2019-时间的答案/" style="font-size: 15px;">中国经济2019,时间的答案</a> <a href="/tags/未来简史-书评/" style="font-size: 15px;">未来简史,书评</a> <a href="/tags/潜规则-书评/" style="font-size: 15px;">潜规则,书评</a> <a href="/tags/图像处理/" style="font-size: 15px;">图像处理</a> <a href="/tags/你好疯子，影评/" style="font-size: 15px;">你好疯子，影评</a> <a href="/tags/熊镇-书评/" style="font-size: 15px;">熊镇,书评</a> <a href="/tags/openMVG-openMVS学习/" style="font-size: 15px;">openMVG openMVS学习</a> <a href="/tags/喜剧之王，影评/" style="font-size: 15px;">喜剧之王，影评</a> <a href="/tags/The-Legend-of-1900/" style="font-size: 15px;">The Legend of 1900</a> <a href="/tags/随感，毕业/" style="font-size: 15px;">随感，毕业</a> <a href="/tags/随感-摄影测量/" style="font-size: 15px;">随感-摄影测量</a> <a href="/tags/校正方法，控制点，光束法平差/" style="font-size: 15px;">校正方法，控制点，光束法平差</a> <a href="/tags/linux学习/" style="font-size: 15px;">linux学习</a> <a href="/tags/月亮与六便士/" style="font-size: 15px;">月亮与六便士</a> <a href="/tags/电影十二公民/" style="font-size: 15px;">电影十二公民</a> <a href="/tags/V字仇杀队-浪潮，影评/" style="font-size: 15px;">V字仇杀队,浪潮，影评</a> <a href="/tags/小说/" style="font-size: 15px;">小说</a> <a href="/tags/随感－代码重构/" style="font-size: 15px;">随感－代码重构</a> <a href="/tags/随感，死亡/" style="font-size: 15px;">随感，死亡</a> <a href="/tags/遗愿清单，影评/" style="font-size: 15px;">遗愿清单，影评</a> <a href="/tags/指环王，这个杀手不太冷/" style="font-size: 15px;">指环王，这个杀手不太冷</a> <a href="/tags/R-学习/" style="font-size: 15px;">R 学习</a> <a href="/tags/点云处理/" style="font-size: 15px;">点云处理</a> <a href="/tags/狗子日记/" style="font-size: 15px;">狗子日记</a> <a href="/tags/爱乐之城，影评/" style="font-size: 15px;">爱乐之城，影评</a> <a href="/tags/一个叫欧维的男人决定去死，书评/" style="font-size: 15px;">一个叫欧维的男人决定去死，书评</a> <a href="/tags/星际穿越，影评/" style="font-size: 15px;">星际穿越，影评</a> <a href="/tags/图像处理的数学原理/" style="font-size: 15px;">图像处理的数学原理</a> <a href="/tags/社交网络，影评/" style="font-size: 15px;">社交网络，影评</a> <a href="/tags/共产党宣言/" style="font-size: 15px;">共产党宣言</a> <a href="/tags/秒速五厘米/" style="font-size: 15px;">秒速五厘米</a> <a href="/tags/海涛之声，影评/" style="font-size: 15px;">海涛之声，影评</a> <a href="/tags/白日梦想家，影评/" style="font-size: 15px;">白日梦想家，影评</a> <a href="/tags/饥荒/" style="font-size: 15px;">饥荒</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/01/31/社会与资本/">社会与资本</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/25/有那么一瞬间/">有那么一瞬间</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/06/死亡记录/">死亡记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/06/不读书-九/">不读书(九)</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/16/挣扎/">挣扎</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/02/点到三维空间直线距离计算以向量方式计算/">点到三维空间直线距离计算以向量方式计算</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/30/ArcGIS-结合-WebGL动态渲染1/">ArcGIS 结合 WebGL动态渲染1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/30/狗子日记十一月四号/">狗子日记十一月四号</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/18/点云处理总结/">点云处理总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/13/关于方向/">关于方向</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/RemoteSensingFrank" title="Github" target="_blank">Github</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">吴蔚.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>